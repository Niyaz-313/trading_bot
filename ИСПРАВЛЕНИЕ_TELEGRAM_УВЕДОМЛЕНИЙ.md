# ИСПРАВЛЕНИЕ: Уведомления в Telegram для всех позиций

## Проблема:
В Telegram не приходили уведомления о покупках/продажах для некоторых позиций (BBGPLDRUBTOM, PLTRUBTOM и других валютных пар), хотя сделки выполнялись и отображались в "Последние сделки".

## Причина:
При отправке уведомлений использовался символ в формате FIGI (BBGPLDRUBTOM) вместо тикера (PLDRUB_TOM), что могло вызывать проблемы с форматированием или отображением сообщений.

## Исправление:

### 1. Преобразование FIGI в тикер перед отправкой уведомлений
Во всех местах отправки уведомлений в Telegram добавлено преобразование символа:
- Покупка (BUY)
- Продажа (SELL)
- Стоп-лосс
- Тейк-профит

### 2. Улучшена функция `_canon_symbol`
Теперь она правильно обрабатывает FIGI, начинающиеся с BBG:
- BBGPLDRUBTOM → PLDRUB_TOM
- BBGPLTRUBTOM → PLTRUB_TOM
- И другие валютные пары

## Изменённые файлы:
- `main.py` - добавлено преобразование символов перед отправкой уведомлений

## Установка на сервере:

### Шаг 1: Отправить изменения
На локальном ПК:
```batch
cd "C:\Users\karim\OneDrive\Рабочий стол\Bot"
git add main.py ИСПРАВЛЕНИЕ_TELEGRAM_УВЕДОМЛЕНИЙ.md
git commit -m "Исправлены уведомления в Telegram для всех позиций (FIGI -> тикер)"
git push origin main
```

### Шаг 2: Обновить на сервере
На сервере:
```bash
cd /home/botuser/trading_bot/trading_bot
git pull origin main
sudo systemctl restart trading-bot.service
```

### Шаг 3: Проверка
После перезапуска проверьте, что уведомления приходят для всех позиций, включая валютные пары.

## Результат:
Теперь все уведомления в Telegram будут приходить с правильными тикерами:
- ✅ PLDRUB_TOM вместо BBGPLDRUBTOM
- ✅ PLTRUB_TOM вместо BBGPLTRUBTOM
- ✅ И другие валютные пары




