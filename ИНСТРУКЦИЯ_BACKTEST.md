# üìä –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é backtest.py

## ‚úÖ –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–∫—Ü–∏–π –±–µ—Ä—É—Ç—Å—è **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ T‚ÄëInvest API** (–¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç –±—Ä–æ–∫–µ—Ä–∞). Yahoo/yfinance –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å backtest (–†–§ –∞–∫—Ü–∏–∏)

**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–∫—Ü–∏—è—Ö:**

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —É–∫–∞–∑–∞–Ω `TINVEST_TOKEN`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```bash
   python backtest.py
   ```
3. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç T-Invest API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –∞–∫—Ü–∏—è–º–∏ (SBER, GAZP, YNDX –∏ —Ç.–¥.)
- ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç –±—Ä–æ–∫–µ—Ä–∞
- ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∏ —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –í `.env` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω `TINVEST_TOKEN` (—Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω)
2. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π SDK `tinkoff.invest` (—Å–º. `–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–£–°–¢–ê–ù–û–í–ö–ò_SDK.md`)

## üìã –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç backtest

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ:

- **–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å:** –û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫:** –ü–æ–∫—É–ø–∫–∏, –ø—Ä–æ–¥–∞–∂–∏, –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ, —É–±—ã—Ç–æ—á–Ω—ã–µ
- **–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥:** –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞
- **–ü—Ä–∏–±—ã–ª—å/–£–±—ã—Ç–æ–∫:** –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å –∏ —É–±—ã—Ç–∫–∏
- **–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å:** –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### T-Invest API

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ `market_data.get_candles()`:
- –ü–æ–ª—É—á–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–≤–µ—á–∏ –ø–æ FIGI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–∏–æ–¥—ã: 1y, 6mo, 3mo, 1mo, 5d
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã: 1m, 5m, 15m, 1h, 1d
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç pandas DataFrame

### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç/–Ω–µ—Ç (–ø—Ä–∞–∑–¥–Ω–∏–∫–∏/–≤—ã—Ö–æ–¥–Ω—ã–µ), –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫—ç—à `data_cache/` –∏ –ø–µ—Ä–∏–æ–¥ `BACKTEST_PERIOD`.

## üîç –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ backtest –≤—ã —É–≤–∏–¥–∏—Ç–µ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:

```
üìä SBER:
   –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª: $10,000.00
   –ö–æ–Ω–µ—á–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª: $11,500.00
   –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: +15.00%
   –í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫: 25
   –ü–æ–∫—É–ø–æ–∫: 12, –ü—Ä–æ–¥–∞–∂: 13
   –ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö: 8, –£–±—ã—Ç–æ—á–Ω—ã—Ö: 5
   –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥: 61.5%
   –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å: $2,500.00
   –û–±—â–∏–π —É–±—ã—Ç–æ–∫: $1,000.00
   –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å: $1,500.00
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- **Backtest –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –≤ –±—É–¥—É—â–µ–º** ‚Äî –æ–Ω –Ω—É–∂–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
- –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –ø–µ—Å–æ—á–Ω–∏—Ü—ã (`TINVEST_SANDBOX=true`) –∏ –Ω–µ–±–æ–ª—å—à–∏—Ö –ª–∏–º–∏—Ç–æ–≤ —Ä–∏—Å–∫–∞.

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
3. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é —Ç–æ—Ä–≥–æ–≤–ª—é
4. –ù–∞—á–Ω–∏—Ç–µ —Å –ø–µ—Å–æ—á–Ω–∏—Ü—ã (TINVEST_SANDBOX=true)

–í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ
